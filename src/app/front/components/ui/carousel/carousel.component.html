<div class="carousel shell"
     [class.variant-focus]="variant === 'focus'"
     [class.variant-filmstrip]="variant === 'filmstrip'"
     [class.variant-split]="variant === 'split'"
     [class.framed]="framed"
     [style.--carousel-height]="autoHeight()"
     (keydown)="keyHandler($event)"
     tabindex="0"
     aria-roledescription="carousel">
  <div #viewport class="viewport">
    <div class="track">
      @for (img of images; let i = $index; track img) {
      <div class="slide" [class.active]="activeIndex() === i">
        <div class="media"
             [class.kenburns]="kenBurns && activeIndex() === i"
             [style.--fit]="objectFit">
          <img [src]="img"
               [alt]="altFor(i)"
               loading="lazy"
               decoding="async"
               [attr.sizes]="variant === 'split' ? '(min-width:900px) 70vw, 100vw' : '100vw'"
               [attr.srcset]="img"/>
          <div class="gradient-top"></div>
          <div class="gradient-bottom"></div>
        </div>
      </div>
      }
    </div>
  </div>

  @if (!disableProgress) {
  <div class="progress" role="progressbar"
       [attr.aria-valuenow]="progress()"
       aria-valuemin="0"
       aria-valuemax="100">
    <div class="bar" [style.width.%]="progress()"></div>
  </div>
  }

  <div class="nav primary">
    <button type="button"
            class="btn prev"
            (click)="prev()"
            [disabled]="!canPrev()"
            aria-label="Précédent">
      <svg viewBox="0 0 24 24"><path fill="currentColor" d="M10.5 19.5 3 12l7.5-7.5 1.06 1.06L6.12 11h14.38v2H6.12l5.44 5.44-1.06 1.06Z"/></svg>
    </button>
    <button type="button"
            class="btn next"
            (click)="next()"
            [disabled]="!canNext()"
            aria-label="Suivant">
      <svg viewBox="0 0 24 24"><path fill="currentColor" d="m13.5 4.5 7.5 7.5-7.5 7.5-1.06-1.06L17.88 13H3.5v-2h14.38L12.44 5.56 13.5 4.5Z"/></svg>
    </button>
  </div>

  @if (showThumbnails && images.length > 1) {
  <div class="thumbs"
       [class.vertical]="variant === 'split'">
    @for (img of images; let i = $index; track img) {
    <button type="button"
            class="thumb"
            [class.active]="activeIndex() === i"
            (click)="goTo(i)"
            [attr.aria-label]="'Aller à l’image ' + (i + 1)">
      <img [src]="img" [alt]="altFor(i)" loading="lazy" />
      <span class="ring"></span>
    </button>
    }
    @if (images.length > 9) {
      <div class="more-indicator">+{{ images.length - 9 }}</div>
    }
  </div>
  }
</div>